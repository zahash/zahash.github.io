import{e as Cn,l as yt,F as K,b as Ft,m as ne,R as Fe,S as re,P as je,c as We}from"./index-BrJcZ8dS.js";import{V as jt,b as An,a as R,E as F,S as Ce,D as Rt,G as Pn,W as He,l as Tn}from"./index-ngxTHCYc.js";const Nn=1024;let In=0;class Ut{constructor(t,e){this.from=t,this.to=e}}class y{constructor(t={}){this.id=In++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=t.combine||null}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=_.match(t)),e=>{let n=t(e);return n===void 0?null:[this,n]}}}y.closedBy=new y({deserialize:i=>i.split(" ")});y.openedBy=new y({deserialize:i=>i.split(" ")});y.group=new y({deserialize:i=>i.split(" ")});y.isolate=new y({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});y.contextHash=new y({perNode:!0});y.lookAhead=new y({perNode:!0});y.mounted=new y({perNode:!0});class xt{constructor(t,e,n,r=!1){this.tree=t,this.overlay=e,this.parser=n,this.bracketed=r}static get(t){return t&&t.props&&t.props[y.mounted.id]}}const Bn=Object.create(null);class _{constructor(t,e,n,r=0){this.name=t,this.props=e,this.id=n,this.flags=r}static define(t){let e=t.props&&t.props.length?Object.create(null):Bn,n=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),r=new _(t.name||"",e,t.id,n);if(t.props){for(let s of t.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[s[0].id]=s[1]}}return r}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(y.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let n in t)for(let r of n.split(" "))e[r]=t[n];return n=>{for(let r=n.prop(y.group),s=-1;s<(r?r.length:0);s++){let l=e[s<0?n.name:r[s]];if(l)return l}}}}_.none=new _("",Object.create(null),0,8);class ie{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let n of this.types){let r=null;for(let s of t){let l=s(n);if(l){r||(r=Object.assign({},n.props));let o=l[1],a=l[0];a.combine&&a.id in r&&(o=a.combine(r[a.id],o)),r[a.id]=o}}e.push(r?new _(n.name,r,n.id,n.flags):n)}return new ie(e)}}const It=new WeakMap,Ae=new WeakMap;var I;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays",i[i.EnterBracketed=16]="EnterBracketed"})(I||(I={}));class C{constructor(t,e,n,r,s){if(this.type=t,this.children=e,this.positions=n,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[l,o]of s)this.props[typeof l=="number"?l:l.id]=o}}toString(){let t=xt.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let n of this.children){let r=n.toString();r&&(e&&(e+=","),e+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Qt(this.topNode,t)}cursorAt(t,e=0,n=0){let r=It.get(this)||this.topNode,s=new Qt(r);return s.moveTo(t,e),It.set(this,s._tree),s}get topNode(){return new U(this,0,0,null)}resolve(t,e=0){let n=wt(It.get(this)||this.topNode,t,e,!1);return It.set(this,n),n}resolveInner(t,e=0){let n=wt(Ae.get(this)||this.topNode,t,e,!0);return Ae.set(this,n),n}resolveStack(t,e=0){return Mn(this,t,e)}iterate(t){let{enter:e,leave:n,from:r=0,to:s=this.length}=t,l=t.mode||0,o=(l&I.IncludeAnonymous)>0;for(let a=this.cursor(l|I.IncludeAnonymous);;){let h=!1;if(a.from<=s&&a.to>=r&&(!o&&a.type.isAnonymous||e(a)!==!1)){if(a.firstChild())continue;h=!0}for(;h&&n&&(o||!a.type.isAnonymous)&&n(a),!a.nextSibling();){if(!a.parent())return;h=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:oe(_.none,this.children,this.positions,0,this.children.length,0,this.length,(e,n,r)=>new C(this.type,e,n,r,this.propValues),t.makeTree||((e,n,r)=>new C(_.none,e,n,r)))}static build(t){return En(t)}}C.empty=new C(_.none,[],[],0);class se{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new se(this.buffer,this.index)}}class it{constructor(t,e,n){this.buffer=t,this.length=e,this.set=n}get type(){return _.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],n=this.buffer[t+3],r=this.set.types[e],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),t+=4,n==t)return s;let l=[];for(;t<n;)l.push(this.childString(t)),t=this.buffer[t+3];return s+"("+l.join(",")+")"}findChild(t,e,n,r,s){let{buffer:l}=this,o=-1;for(let a=t;a!=e&&!(Ue(s,r,l[a+1],l[a+2])&&(o=a,n>0));a=l[a+3]);return o}slice(t,e,n){let r=this.buffer,s=new Uint16Array(e-t),l=0;for(let o=t,a=0;o<e;){s[a++]=r[o++],s[a++]=r[o++]-n;let h=s[a++]=r[o++]-n;s[a++]=r[o++]-t,l=Math.max(l,h)}return new it(s,l,this.set)}}function Ue(i,t,e,n){switch(i){case-2:return e<t;case-1:return n>=t&&e<t;case 0:return e<t&&n>t;case 1:return e<=t&&n>t;case 2:return n>t;case 4:return!0}}function wt(i,t,e,n){for(var r;i.from==i.to||(e<1?i.from>=t:i.from>t)||(e>-1?i.to<=t:i.to<t);){let l=!n&&i instanceof U&&i.index<0?null:i.parent;if(!l)return i;i=l}let s=n?0:I.IgnoreOverlays;if(n)for(let l=i,o=l.parent;o;l=o,o=l.parent)l instanceof U&&l.index<0&&((r=o.enter(t,e,s))===null||r===void 0?void 0:r.from)!=l.from&&(i=o);for(;;){let l=i.enter(t,e,s);if(!l)return i;i=l}}class Ve{cursor(t=0){return new Qt(this,t)}getChild(t,e=null,n=null){let r=Pe(this,t,e,n);return r.length?r[0]:null}getChildren(t,e=null,n=null){return Pe(this,t,e,n)}resolve(t,e=0){return wt(this,t,e,!1)}resolveInner(t,e=0){return wt(this,t,e,!0)}matchContext(t){return Kt(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),n=this;for(;e;){let r=e.lastChild;if(!r||r.to!=e.to)break;r.type.isError&&r.from==r.to?(n=e,e=r.prevSibling):e=r}return n}get node(){return this}get next(){return this.parent}}class U extends Ve{constructor(t,e,n,r){super(),this._tree=t,this.from=e,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,n,r,s=0){for(let l=this;;){for(let{children:o,positions:a}=l._tree,h=e>0?o.length:-1;t!=h;t+=e){let f=o[t],d=a[t]+l.from,g;if(!(!(s&I.EnterBracketed&&f instanceof C&&(g=xt.get(f))&&!g.overlay&&g.bracketed&&n>=d&&n<=d+f.length)&&!Ue(r,n,d,d+f.length))){if(f instanceof it){if(s&I.ExcludeBuffers)continue;let k=f.findChild(0,f.buffer.length,e,n-d,r);if(k>-1)return new nt(new On(l,f,t,d),null,k)}else if(s&I.IncludeAnonymous||!f.type.isAnonymous||le(f)){let k;if(!(s&I.IgnoreMounts)&&(k=xt.get(f))&&!k.overlay)return new U(k.tree,d,t,l);let w=new U(f,d,t,l);return s&I.IncludeAnonymous||!w.type.isAnonymous?w:w.nextChild(e<0?f.children.length-1:0,e,n,r,s)}}}if(s&I.IncludeAnonymous||!l.type.isAnonymous||(l.index>=0?t=l.index+e:t=e<0?-1:l._parent._tree.children.length,l=l._parent,!l))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}prop(t){return this._tree.prop(t)}enter(t,e,n=0){let r;if(!(n&I.IgnoreOverlays)&&(r=xt.get(this._tree))&&r.overlay){let s=t-this.from,l=n&I.EnterBracketed&&r.bracketed;for(let{from:o,to:a}of r.overlay)if((e>0||l?o<=s:o<s)&&(e<0||l?a>=s:a>s))return new U(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,n)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Pe(i,t,e,n){let r=i.cursor(),s=[];if(!r.firstChild())return s;if(e!=null){for(let l=!1;!l;)if(l=r.type.is(e),!r.nextSibling())return s}for(;;){if(n!=null&&r.type.is(n))return s;if(r.type.is(t)&&s.push(r.node),!r.nextSibling())return n==null?s:[]}}function Kt(i,t,e=t.length-1){for(let n=i;e>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[e]&&t[e]!=n.name)return!1;e--}}return!0}class On{constructor(t,e,n,r){this.parent=t,this.buffer=e,this.index=n,this.start=r}}class nt extends Ve{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,n){super(),this.context=t,this._parent=e,this.index=n,this.type=t.buffer.set.types[t.buffer.buffer[n]]}child(t,e,n){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t,e-this.context.start,n);return s<0?null:new nt(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}prop(t){return this.type.prop(t)}enter(t,e,n=0){if(n&I.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return s<0?null:new nt(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new nt(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new nt(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:n}=this.context,r=this.index+4,s=n.buffer[this.index+3];if(s>r){let l=n.buffer[this.index+1];t.push(n.slice(r,s,l)),e.push(0)}return new C(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function $e(i){if(!i.length)return null;let t=0,e=i[0];for(let s=1;s<i.length;s++){let l=i[s];(l.from>e.from||l.to<e.to)&&(e=l,t=s)}let n=e instanceof U&&e.index<0?null:e.parent,r=i.slice();return n?r[t]=n:r.splice(t,1),new Dn(r,e)}class Dn{constructor(t,e){this.heads=t,this.node=e}get next(){return $e(this.heads)}}function Mn(i,t,e){let n=i.resolveInner(t,e),r=null;for(let s=n instanceof U?n:n.context.parent;s;s=s.parent)if(s.index<0){let l=s.parent;(r||(r=[n])).push(l.resolve(t,e)),s=l}else{let l=xt.get(s.tree);if(l&&l.overlay&&l.overlay[0].from<=t&&l.overlay[l.overlay.length-1].to>=t){let o=new U(l.tree,l.overlay[0].from+s.from,-1,s);(r||(r=[n])).push(wt(o,t,e,!1))}}return r?$e(r):n}class Qt{get name(){return this.type.name}constructor(t,e=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=e&~I.EnterBracketed,t instanceof U)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let n=t._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:n,buffer:r}=this.buffer;return this.type=e||r.set.types[r.buffer[t]],this.from=n+r.buffer[t+1],this.to=n+r.buffer[t+2],!0}yield(t){return t?t instanceof U?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,n){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,n,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],t,e-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,n=this.mode){return this.buffer?n&I.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&I.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&I.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,n=this.stack.length-1;if(t<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(e.findChild(r,this.index,-1,0,4))}else{let r=e.buffer[this.index+3];if(r<(n<0?e.buffer.length:e.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,n,{buffer:r}=this;if(r){if(t>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:e,parent:n}=r)}else({index:e,_parent:n}=this._tree);for(;n;{index:e,_parent:n}=n)if(e>-1)for(let s=e+t,l=t<0?-1:n._tree.children.length;s!=l;s+=t){let o=n._tree.children[s];if(this.mode&I.IncludeAnonymous||o instanceof it||!o.type.isAnonymous||le(o))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,n=0;if(t&&t.context==this.buffer)t:for(let r=this.index,s=this.stack.length;s>=0;){for(let l=t;l;l=l._parent)if(l.index==r){if(r==this.index)return l;e=l,n=s+1;break t}r=this.stack[--s]}for(let r=n;r<this.stack.length;r++)e=new nt(this.buffer,e,this.stack[r]);return this.bufferNode=new nt(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let n=0;;){let r=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&e&&e(this),r=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,r=!0}}}matchContext(t){if(!this.buffer)return Kt(this.node.parent,t);let{buffer:e}=this.buffer,{types:n}=e.set;for(let r=t.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return Kt(this._tree,t,r);let l=n[e.buffer[this.stack[s]]];if(!l.isAnonymous){if(t[r]&&t[r]!=l.name)return!1;r--}}return!0}}function le(i){return i.children.some(t=>t instanceof it||!t.type.isAnonymous||le(t))}function En(i){var t;let{buffer:e,nodeSet:n,maxBufferLength:r=Nn,reused:s=[],minRepeatType:l=n.types.length}=i,o=Array.isArray(e)?new se(e,e.length):e,a=n.types,h=0,f=0;function d(x,A,p,T,v,N){let{id:b,start:m,end:S,size:P}=o,D=f,Z=h;if(P<0)if(o.next(),P==-1){let Q=s[b];p.push(Q),T.push(m-x);return}else if(P==-3){h=b;return}else if(P==-4){f=b;return}else throw new RangeError(`Unrecognized record size: ${P}`);let gt=a[b],Tt,st,ve=m-x;if(S-m<=r&&(st=j(o.pos-A,v))){let Q=new Uint16Array(st.size-st.skip),W=o.pos-st.size,$=Q.length;for(;o.pos>W;)$=M(st.start,Q,$);Tt=new it(Q,S-st.start,n),ve=st.start-x}else{let Q=o.pos-P;o.next();let W=[],$=[],lt=b>=l?b:-1,ut=0,Nt=S;for(;o.pos>Q;)lt>=0&&o.id==lt&&o.size>=0?(o.end<=Nt-r&&(w(W,$,m,ut,o.end,Nt,lt,D,Z),ut=W.length,Nt=o.end),o.next()):N>2500?g(m,Q,W,$):d(m,Q,W,$,lt,N+1);if(lt>=0&&ut>0&&ut<W.length&&w(W,$,m,ut,m,Nt,lt,D,Z),W.reverse(),$.reverse(),lt>-1&&ut>0){let Se=k(gt,Z);Tt=oe(gt,W,$,0,W.length,0,S-m,Se,Se)}else Tt=O(gt,W,$,S-m,D-S,Z)}p.push(Tt),T.push(ve)}function g(x,A,p,T){let v=[],N=0,b=-1;for(;o.pos>A;){let{id:m,start:S,end:P,size:D}=o;if(D>4)o.next();else{if(b>-1&&S<b)break;b<0&&(b=P-r),v.push(m,S,P),N++,o.next()}}if(N){let m=new Uint16Array(N*4),S=v[v.length-2];for(let P=v.length-3,D=0;P>=0;P-=3)m[D++]=v[P],m[D++]=v[P+1]-S,m[D++]=v[P+2]-S,m[D++]=D;p.push(new it(m,v[2]-S,n)),T.push(S-x)}}function k(x,A){return(p,T,v)=>{let N=0,b=p.length-1,m,S;if(b>=0&&(m=p[b])instanceof C){if(!b&&m.type==x&&m.length==v)return m;(S=m.prop(y.lookAhead))&&(N=T[b]+m.length+S)}return O(x,p,T,v,N,A)}}function w(x,A,p,T,v,N,b,m,S){let P=[],D=[];for(;x.length>T;)P.push(x.pop()),D.push(A.pop()+p-v);x.push(O(n.types[b],P,D,N-v,m-N,S)),A.push(v-p)}function O(x,A,p,T,v,N,b){if(N){let m=[y.contextHash,N];b=b?[m].concat(b):[m]}if(v>25){let m=[y.lookAhead,v];b=b?[m].concat(b):[m]}return new C(x,A,p,T,b)}function j(x,A){let p=o.fork(),T=0,v=0,N=0,b=p.end-r,m={size:0,start:0,skip:0};t:for(let S=p.pos-x;p.pos>S;){let P=p.size;if(p.id==A&&P>=0){m.size=T,m.start=v,m.skip=N,N+=4,T+=4,p.next();continue}let D=p.pos-P;if(P<0||D<S||p.start<b)break;let Z=p.id>=l?4:0,gt=p.start;for(p.next();p.pos>D;){if(p.size<0)if(p.size==-3||p.size==-4)Z+=4;else break t;else p.id>=l&&(Z+=4);p.next()}v=gt,T+=P,N+=Z}return(A<0||T==x)&&(m.size=T,m.start=v,m.skip=N),m.size>4?m:void 0}function M(x,A,p){let{id:T,start:v,end:N,size:b}=o;if(o.next(),b>=0&&T<l){let m=p;if(b>4){let S=o.pos-(b-4);for(;o.pos>S;)p=M(x,A,p)}A[--p]=m,A[--p]=N-x,A[--p]=v-x,A[--p]=T}else b==-3?h=T:b==-4&&(f=T);return p}let z=[],B=[];for(;o.pos>0;)d(i.start||0,i.bufferStart||0,z,B,-1,0);let V=(t=i.length)!==null&&t!==void 0?t:z.length?B[0]+z[0].length:0;return new C(a[i.topID],z.reverse(),B.reverse(),V)}const Te=new WeakMap;function Mt(i,t){if(!i.isAnonymous||t instanceof it||t.type!=i)return 1;let e=Te.get(t);if(e==null){e=1;for(let n of t.children){if(n.type!=i||!(n instanceof C)){e=1;break}e+=Mt(i,n)}Te.set(t,e)}return e}function oe(i,t,e,n,r,s,l,o,a){let h=0;for(let w=n;w<r;w++)h+=Mt(i,t[w]);let f=Math.ceil(h*1.5/8),d=[],g=[];function k(w,O,j,M,z){for(let B=j;B<M;){let V=B,x=O[B],A=Mt(i,w[B]);for(B++;B<M;B++){let p=Mt(i,w[B]);if(A+p>=f)break;A+=p}if(B==V+1){if(A>f){let p=w[V];k(p.children,p.positions,0,p.children.length,O[V]+z);continue}d.push(w[V])}else{let p=O[B-1]+w[B-1].length-x;d.push(oe(i,w,O,V,B,x,p,null,a))}g.push(x+z-s)}}return k(t,e,n,r,0),(o||a)(d,g,l)}class at{constructor(t,e,n,r,s=!1,l=!1){this.from=t,this.to=e,this.tree=n,this.offset=r,this.open=(s?1:0)|(l?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],n=!1){let r=[new at(0,t.length,t,0,!1,n)];for(let s of e)s.to>t.length&&r.push(s);return r}static applyChanges(t,e,n=128){if(!e.length)return t;let r=[],s=1,l=t.length?t[0]:null;for(let o=0,a=0,h=0;;o++){let f=o<e.length?e[o]:null,d=f?f.fromA:1e9;if(d-a>=n)for(;l&&l.from<d;){let g=l;if(a>=g.from||d<=g.to||h){let k=Math.max(g.from,a)-h,w=Math.min(g.to,d)-h;g=k>=w?null:new at(k,w,g.tree,g.offset+h,o>0,!!f)}if(g&&r.push(g),l.to>d)break;l=s<t.length?t[s++]:null}if(!f)break;a=f.toA,h=f.toA-f.toB}return r}}class qe{startParse(t,e,n){return typeof t=="string"&&(t=new Rn(t)),n=n?n.length?n.map(r=>new Ut(r.from,r.to)):[new Ut(0,0)]:[new Ut(0,t.length)],this.createParse(t,e||[],n)}parse(t,e,n){let r=this.startParse(t,e,n);for(;;){let s=r.advance();if(s)return s}}}class Rn{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new y({perNode:!0});let _n=0;class H{constructor(t,e,n,r){this.name=t,this.set=e,this.base=n,this.modified=r,this.id=_n++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let n=typeof t=="string"?t:"?";if(t instanceof H&&(e=t),e?.base)throw new Error("Can not derive from a modified tag");let r=new H(n,[],null,[]);if(r.set.push(r),e)for(let s of e.set)r.set.push(s);return r}static defineModifier(t){let e=new _t(t);return n=>n.modified.indexOf(e)>-1?n:_t.get(n.base||n,n.modified.concat(e).sort((r,s)=>r.id-s.id))}}let Ln=0;class _t{constructor(t){this.name=t,this.instances=[],this.id=Ln++}static get(t,e){if(!e.length)return t;let n=e[0].instances.find(o=>o.base==t&&zn(e,o.modified));if(n)return n;let r=[],s=new H(t.name,r,t,e);for(let o of e)o.instances.push(s);let l=Fn(e);for(let o of t.set)if(!o.modified.length)for(let a of l)r.push(_t.get(o,a));return s}}function zn(i,t){return i.length==t.length&&i.every((e,n)=>e==t[n])}function Fn(i){let t=[[]];for(let e=0;e<i.length;e++)for(let n=0,r=t.length;n<r;n++)t.push(t[n].concat(i[e]));return t.sort((e,n)=>n.length-e.length)}function jn(i){let t=Object.create(null);for(let e in i){let n=i[e];Array.isArray(n)||(n=[n]);for(let r of e.split(" "))if(r){let s=[],l=2,o=r;for(let d=0;;){if(o=="..."&&d>0&&d+3==r.length){l=1;break}let g=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!g)throw new RangeError("Invalid path: "+r);if(s.push(g[0]=="*"?"":g[0][0]=='"'?JSON.parse(g[0]):g[0]),d+=g[0].length,d==r.length)break;let k=r[d++];if(d==r.length&&k=="!"){l=0;break}if(k!="/")throw new RangeError("Invalid path: "+r);o=r.slice(d)}let a=s.length-1,h=s[a];if(!h)throw new RangeError("Invalid path: "+r);let f=new vt(n,l,a>0?s.slice(0,a):null);t[h]=f.sort(t[h])}}return Ge.add(t)}const Ge=new y({combine(i,t){let e,n,r;for(;i||t;){if(!i||t&&i.depth>=t.depth?(r=t,t=t.next):(r=i,i=i.next),e&&e.mode==r.mode&&!r.context&&!e.context)continue;let s=new vt(r.tags,r.mode,r.context);e?e.next=s:n=s,e=s}return n}});class vt{constructor(t,e,n,r){this.tags=t,this.mode=e,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}vt.empty=new vt([],2,null);function Je(i,t){let e=Object.create(null);for(let s of i)if(!Array.isArray(s.tag))e[s.tag.id]=s.class;else for(let l of s.tag)e[l.id]=s.class;let{scope:n,all:r=null}=t||{};return{style:s=>{let l=r;for(let o of s)for(let a of o.set){let h=e[a.id];if(h){l=l?l+" "+h:h;break}}return l},scope:n}}function Wn(i,t){let e=null;for(let n of i){let r=n.style(t);r&&(e=e?e+" "+r:r)}return e}function Hn(i,t,e,n=0,r=i.length){let s=new Un(n,Array.isArray(t)?t:[t],e);s.highlightRange(i.cursor(),n,r,"",s.highlighters),s.flush(r)}class Un{constructor(t,e,n){this.at=t,this.highlighters=e,this.span=n,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,n,r,s){let{type:l,from:o,to:a}=t;if(o>=n||a<=e)return;l.isTop&&(s=this.highlighters.filter(k=>!k.scope||k.scope(l)));let h=r,f=Vn(t)||vt.empty,d=Wn(s,f.tags);if(d&&(h&&(h+=" "),h+=d,f.mode==1&&(r+=(r?" ":"")+d)),this.startSpan(Math.max(e,o),h),f.opaque)return;let g=t.tree&&t.tree.prop(y.mounted);if(g&&g.overlay){let k=t.node.enter(g.overlay[0].from+o,1),w=this.highlighters.filter(j=>!j.scope||j.scope(g.tree.type)),O=t.firstChild();for(let j=0,M=o;;j++){let z=j<g.overlay.length?g.overlay[j]:null,B=z?z.from+o:a,V=Math.max(e,M),x=Math.min(n,B);if(V<x&&O)for(;t.from<x&&(this.highlightRange(t,V,x,r,s),this.startSpan(Math.min(x,t.to),h),!(t.to>=B||!t.nextSibling())););if(!z||B>n)break;M=z.to+o,M>e&&(this.highlightRange(k.cursor(),Math.max(e,z.from+o),Math.min(n,M),"",w),this.startSpan(Math.min(n,M),h))}O&&t.parent()}else if(t.firstChild()){g&&(r="");do if(!(t.to<=e)){if(t.from>=n)break;this.highlightRange(t,e,n,r,s),this.startSpan(Math.min(n,t.to),h)}while(t.nextSibling());t.parent()}}}function Vn(i){let t=i.type.prop(Ge);for(;t&&t.context&&!i.matchContext(t.context);)t=t.next;return t||null}const u=H.define,Bt=u(),tt=u(),Ne=u(tt),Ie=u(tt),et=u(),Ot=u(et),Vt=u(et),J=u(),ot=u(J),q=u(),G=u(),Xt=u(),mt=u(Xt),Dt=u(),c={comment:Bt,lineComment:u(Bt),blockComment:u(Bt),docComment:u(Bt),name:tt,variableName:u(tt),typeName:Ne,tagName:u(Ne),propertyName:Ie,attributeName:u(Ie),className:u(tt),labelName:u(tt),namespace:u(tt),macroName:u(tt),literal:et,string:Ot,docString:u(Ot),character:u(Ot),attributeValue:u(Ot),number:Vt,integer:u(Vt),float:u(Vt),bool:u(et),regexp:u(et),escape:u(et),color:u(et),url:u(et),keyword:q,self:u(q),null:u(q),atom:u(q),unit:u(q),modifier:u(q),operatorKeyword:u(q),controlKeyword:u(q),definitionKeyword:u(q),moduleKeyword:u(q),operator:G,derefOperator:u(G),arithmeticOperator:u(G),logicOperator:u(G),bitwiseOperator:u(G),compareOperator:u(G),updateOperator:u(G),definitionOperator:u(G),typeOperator:u(G),controlOperator:u(G),punctuation:Xt,separator:u(Xt),bracket:mt,angleBracket:u(mt),squareBracket:u(mt),paren:u(mt),brace:u(mt),content:J,heading:ot,heading1:u(ot),heading2:u(ot),heading3:u(ot),heading4:u(ot),heading5:u(ot),heading6:u(ot),contentSeparator:u(J),list:u(J),quote:u(J),emphasis:u(J),strong:u(J),link:u(J),monospace:u(J),strikethrough:u(J),inserted:u(),deleted:u(),changed:u(),invalid:u(),meta:Dt,documentMeta:u(Dt),annotation:u(Dt),processingInstruction:u(Dt),definition:H.defineModifier("definition"),constant:H.defineModifier("constant"),function:H.defineModifier("function"),standard:H.defineModifier("standard"),local:H.defineModifier("local"),special:H.defineModifier("special")};for(let i in c){let t=c[i];t instanceof H&&(t.name=i)}Je([{tag:c.link,class:"tok-link"},{tag:c.heading,class:"tok-heading"},{tag:c.emphasis,class:"tok-emphasis"},{tag:c.strong,class:"tok-strong"},{tag:c.keyword,class:"tok-keyword"},{tag:c.atom,class:"tok-atom"},{tag:c.bool,class:"tok-bool"},{tag:c.url,class:"tok-url"},{tag:c.labelName,class:"tok-labelName"},{tag:c.inserted,class:"tok-inserted"},{tag:c.deleted,class:"tok-deleted"},{tag:c.literal,class:"tok-literal"},{tag:c.string,class:"tok-string"},{tag:c.number,class:"tok-number"},{tag:[c.regexp,c.escape,c.special(c.string)],class:"tok-string2"},{tag:c.variableName,class:"tok-variableName"},{tag:c.local(c.variableName),class:"tok-variableName tok-local"},{tag:c.definition(c.variableName),class:"tok-variableName tok-definition"},{tag:c.special(c.variableName),class:"tok-variableName2"},{tag:c.definition(c.propertyName),class:"tok-propertyName tok-definition"},{tag:c.typeName,class:"tok-typeName"},{tag:c.namespace,class:"tok-namespace"},{tag:c.className,class:"tok-className"},{tag:c.macroName,class:"tok-macroName"},{tag:c.propertyName,class:"tok-propertyName"},{tag:c.operator,class:"tok-operator"},{tag:c.comment,class:"tok-comment"},{tag:c.meta,class:"tok-meta"},{tag:c.invalid,class:"tok-invalid"},{tag:c.punctuation,class:"tok-punctuation"}]);var $t;const rt=new y;function ae(i){return K.define({combine:i?t=>t.concat(i):void 0})}const Ke=new y;class E{constructor(t,e,n=[],r=""){this.data=t,this.name=r,yt.prototype.hasOwnProperty("tree")||Object.defineProperty(yt.prototype,"tree",{get(){return L(this)}}),this.parser=e,this.extension=[X.of(this),yt.languageData.of((s,l,o)=>{let a=Be(s,l,o),h=a.type.prop(rt);if(!h)return[];let f=s.facet(h),d=a.type.prop(Ke);if(d){let g=a.resolve(l-a.from,o);for(let k of d)if(k.test(g,s)){let w=s.facet(k.facet);return k.type=="replace"?w:w.concat(f)}}return f})].concat(n)}isActiveAt(t,e,n=-1){return Be(t,e,n).type.prop(rt)==this.data}findRegions(t){let e=t.facet(X);if(e?.data==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let n=[],r=(s,l)=>{if(s.prop(rt)==this.data){n.push({from:l,to:l+s.length});return}let o=s.prop(y.mounted);if(o){if(o.tree.prop(rt)==this.data){if(o.overlay)for(let a of o.overlay)n.push({from:a.from+l,to:a.to+l});else n.push({from:l,to:l+s.length});return}else if(o.overlay){let a=n.length;if(r(o.tree,o.overlay[0].from+l),n.length>a)return}}for(let a=0;a<s.children.length;a++){let h=s.children[a];h instanceof C&&r(h,s.positions[a]+l)}};return r(L(t),0),n}get allowsNesting(){return!0}}E.setState=Ft.define();function Be(i,t,e){let n=i.facet(X),r=L(i).topNode;if(!n||n.allowsNesting)for(let s=r;s;s=s.enter(t,e,I.ExcludeBuffers|I.EnterBracketed))s.type.isTop&&(r=s);return r}class Lt extends E{constructor(t,e,n){super(t,e,[],n),this.parser=e}static define(t){let e=ae(t.languageData);return new Lt(e,t.parser.configure({props:[rt.add(n=>n.isTop?e:void 0)]}),t.name)}configure(t,e){return new Lt(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function L(i){let t=i.field(E.state,!1);return t?t.tree:C.empty}function Qe(i,t,e=50){var n;let r=(n=i.field(E.state,!1))===null||n===void 0?void 0:n.context;if(!r)return null;let s=r.viewport;r.updateViewport({from:0,to:t});let l=r.isDone(t)||r.work(e,t)?r.tree:null;return r.updateViewport(s),l}function $n(i,t=i.doc.length){var e;return((e=i.field(E.state,!1))===null||e===void 0?void 0:e.context.isDone(t))||!1}function qn(i,t=i.viewport.to,e=100){let n=Qe(i.state,t,e);return n!=L(i.state)&&i.dispatch({}),!!n}function Gn(i){var t;return((t=i.plugin(Ze))===null||t===void 0?void 0:t.isWorking())||!1}class Xe{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let n=this.cursorPos-this.string.length;return t<n||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-n,e-n)}}let kt=null;class ht{constructor(t,e,n=[],r,s,l,o,a){this.parser=t,this.state=e,this.fragments=n,this.tree=r,this.treeLen=s,this.viewport=l,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,e,n){return new ht(t,e,[],C.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Xe(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=C.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof t=="number"){let r=Date.now()+t;t=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(at.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(at.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=kt;kt=this;try{return t()}finally{kt=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=Oe(t,e.from,e.to);return t}changes(t,e){let{fragments:n,tree:r,treeLen:s,viewport:l,skipped:o}=this;if(this.takeTree(),!t.empty){let a=[];if(t.iterChangedRanges((h,f,d,g)=>a.push({fromA:h,toA:f,fromB:d,toB:g})),n=at.applyChanges(n,a),r=C.empty,s=0,l={from:t.mapPos(l.from,-1),to:t.mapPos(l.to,1)},this.skipped.length){o=[];for(let h of this.skipped){let f=t.mapPos(h.from,1),d=t.mapPos(h.to,-1);f<d&&o.push({from:f,to:d})}}}return new ht(this.parser,e,n,r,s,l,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:r,to:s}=this.skipped[n];r<t.to&&s>t.from&&(this.fragments=Oe(this.fragments,r,s),this.skipped.splice(n--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends qe{createParse(e,n,r){let s=r[0].from,l=r[r.length-1].to;return{parsedPos:s,advance(){let a=kt;if(a){for(let h of r)a.tempSkipped.push(h);t&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,t]):t)}return this.parsedPos=l,new C(_.none,[],[],l-s)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return kt}}function Oe(i,t,e){return at.applyChanges(i,[{fromA:t,toA:e,fromB:t,toB:e}])}class ct{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),n=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,n)||e.takeTree(),new ct(e)}static init(t){let e=Math.min(3e3,t.doc.length),n=ht.create(t.facet(X).parser,t,{from:0,to:e});return n.work(20,e)||n.takeTree(),new ct(n)}}E.state=re.define({create:ct.init,update(i,t){for(let e of t.effects)if(e.is(E.setState))return e.value;return t.startState.facet(X)!=t.state.facet(X)?ct.init(t.state):i.apply(t)}});let Ye=i=>{let t=setTimeout(()=>i(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Ye=i=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(i,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const qt=typeof navigator<"u"&&(!(($t=navigator.scheduling)===null||$t===void 0)&&$t.isInputPending)?()=>navigator.scheduling.isInputPending():null,Ze=jt.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(E.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(E.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=Ye(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:r}}=this.view,s=n.field(E.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let l=Date.now()+Math.min(this.chunkBudget,100,t&&!qt?Math.max(25,t.timeRemaining()-5):1e9),o=s.context.treeLen<r&&n.doc.length>r+1e3,a=s.context.work(()=>qt&&qt()||Date.now()>l,r+(o?0:1e5));this.chunkBudget-=Date.now()-e,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:E.setState.of(new ct(s.context))})),this.chunkBudget>0&&!(a&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Tn(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),X=K.define({combine(i){return i.length?i[0]:null},enables:i=>[E.state,Ze,F.contentAttributes.compute([i],t=>{let e=t.facet(i);return e&&e.name?{"data-language":e.name}:{}})]});class Jn{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}class he{constructor(t,e,n,r,s,l=void 0){this.name=t,this.alias=e,this.extensions=n,this.filename=r,this.loadFunc=s,this.support=l,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(t=>this.support=t,t=>{throw this.loading=null,t}))}static of(t){let{load:e,support:n}=t;if(!e){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(n)}return new he(t.name,(t.alias||[]).concat(t.name).map(r=>r.toLowerCase()),t.extensions||[],t.filename,e,n)}static matchFilename(t,e){for(let r of t)if(r.filename&&r.filename.test(e))return r;let n=/\.([^.]+)$/.exec(e);if(n){for(let r of t)if(r.extensions.indexOf(n[1])>-1)return r}return null}static matchLanguageName(t,e,n=!0){e=e.toLowerCase();for(let r of t)if(r.alias.some(s=>s==e))return r;if(n)for(let r of t)for(let s of r.alias){let l=e.indexOf(s);if(l>-1&&(s.length>2||!/\w/.test(e[l-1])&&!/\w/.test(e[l+s.length])))return r}return null}}const tn=K.define(),fe=K.define({combine:i=>{if(!i.length)return"  ";let t=i[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return t}});function St(i){let t=i.facet(fe);return t.charCodeAt(0)==9?i.tabSize*t.length:t.length}function ue(i,t){let e="",n=i.tabSize,r=i.facet(fe)[0];if(r=="	"){for(;t>=n;)e+="	",t-=n;r=" "}for(let s=0;s<t;s++)e+=r;return e}function ce(i,t){i instanceof yt&&(i=new Wt(i));for(let n of i.state.facet(tn)){let r=n(i,t);if(r!==void 0)return r}let e=L(i.state);return e.length>=t?Qn(i,e,t):null}function Kn(i,t,e){let n=Object.create(null),r=new Wt(i,{overrideIndentation:l=>{var o;return(o=n[l])!==null&&o!==void 0?o:-1}}),s=[];for(let l=t;l<=e;){let o=i.doc.lineAt(l);l=o.to+1;let a=ce(r,o.from);if(a==null)continue;/\S/.test(o.text)||(a=0);let h=/^\s*/.exec(o.text)[0],f=ue(i,a);h!=f&&(n[o.from]=a,s.push({from:o.from,to:o.from+h.length,insert:f}))}return i.changes(s)}class Wt{constructor(t,e={}){this.state=t,this.options=e,this.unit=St(t)}lineAt(t,e=1){let n=this.state.doc.lineAt(t),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=n.from&&r<=n.to?s&&r==t?{text:"",from:t}:(e<0?r<t:r<=t)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(t,e);return n.slice(t-r,Math.min(n.length,t+100-r))}column(t,e=1){let{text:n,from:r}=this.lineAt(t,e),s=this.countColumn(n,t-r),l=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return l>-1&&(s+=l-this.countColumn(n,n.search(/\S|$/))),s}countColumn(t,e=t.length){return Cn(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:n,from:r}=this.lineAt(t,e),s=this.options.overrideIndentation;if(s){let l=s(r);if(l>-1)return l}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const de=new y;function Qn(i,t,e){let n=t.resolveStack(e),r=t.resolveInner(e,-1).resolve(e,0).enterUnfinishedNodesBefore(e);if(r!=n.node){let s=[];for(let l=r;l&&!(l.from<n.node.from||l.to>n.node.to||l.from==n.node.from&&l.type==n.node.type);l=l.parent)s.push(l);for(let l=s.length-1;l>=0;l--)n={node:s[l],next:n}}return en(n,i,e)}function en(i,t,e){for(let n=i;n;n=n.next){let r=Yn(n.node);if(r)return r(Ht.create(t,e,n))}return 0}function Xn(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function Yn(i){let t=i.type.prop(de);if(t)return t;let e=i.firstChild,n;if(e&&(n=e.type.prop(y.closedBy))){let r=i.lastChild,s=r&&n.indexOf(r.name)>-1;return l=>nn(l,!0,1,void 0,s&&!Xn(l)?r.from:void 0)}return i.parent==null?Zn:null}function Zn(){return 0}class Ht extends Wt{constructor(t,e,n){super(t.state,t.options),this.base=t,this.pos=e,this.context=n}get node(){return this.context.node}static create(t,e,n){return new Ht(t,e,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let n=t.resolve(e.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(tr(n,t))break;e=this.state.doc.lineAt(n.from)}return this.lineIndent(e.from)}continue(){return en(this.context.next,this.base,this.pos)}}function tr(i,t){for(let e=t;e;e=e.parent)if(i==e)return!0;return!1}function er(i){let t=i.node,e=t.childAfter(t.from),n=t.lastChild;if(!e)return null;let r=i.options.simulateBreak,s=i.state.doc.lineAt(e.from),l=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let o=e.to;;){let a=t.childAfter(o);if(!a||a==n)return null;if(!a.type.isSkipped){if(a.from>=l)return null;let h=/^ */.exec(s.text.slice(e.to-s.from))[0].length;return{from:e.from,to:e.to+h}}o=a.to}}function nr({closing:i,align:t=!0,units:e=1}){return n=>nn(n,t,e,i)}function nn(i,t,e,n,r){let s=i.textAfter,l=s.match(/^\s*/)[0].length,o=n&&s.slice(l,l+n.length)==n||r==i.pos+l,a=t?er(i):null;return a?o?i.column(a.from):i.column(a.to):i.baseIndent+(o?0:i.unit*e)}const rr=i=>i.baseIndent;function ir({except:i,units:t=1}={}){return e=>{let n=i&&i.test(e.textAfter);return e.baseIndent+(n?0:t*e.unit)}}const sr=200;function lr(){return yt.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let t=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!t.length)return i;let e=i.newDoc,{head:n}=i.newSelection.main,r=e.lineAt(n);if(n>r.from+sr)return i;let s=e.sliceString(r.from,n);if(!t.some(h=>h.test(s)))return i;let{state:l}=i,o=-1,a=[];for(let{head:h}of l.selection.ranges){let f=l.doc.lineAt(h);if(f.from==o)continue;o=f.from;let d=ce(l,f.from);if(d==null)continue;let g=/^\s*/.exec(f.text)[0],k=ue(l,d);g!=k&&a.push({from:f.from,to:f.from+g.length,insert:k})}return a.length?[i,{changes:a,sequential:!0}]:i})}const rn=K.define(),sn=new y;function or(i){let t=i.firstChild,e=i.lastChild;return t&&t.to<e.from?{from:t.to,to:e.type.isError?i.to:e.from}:null}function ar(i,t,e){let n=L(i);if(n.length<e)return null;let r=n.resolveStack(e,1),s=null;for(let l=r;l;l=l.next){let o=l.node;if(o.to<=e||o.from>e)continue;if(s&&o.from<t)break;let a=o.type.prop(sn);if(a&&(o.to<n.length-50||n.length==i.doc.length||!hr(o))){let h=a(o,i);h&&h.from<=e&&h.from>=t&&h.to>e&&(s=h)}}return s}function hr(i){let t=i.lastChild;return t&&t.to==i.to&&t.type.isError}function dt(i,t,e){for(let n of i.facet(rn)){let r=n(i,t,e);if(r)return r}return ar(i,t,e)}function ln(i,t){let e=t.mapPos(i.from,1),n=t.mapPos(i.to,-1);return e>=n?void 0:{from:e,to:n}}const pt=Ft.define({map:ln}),ft=Ft.define({map:ln});function pe(i){let t=[];for(let{head:e}of i.state.selection.ranges)t.some(n=>n.from<=e&&n.to>=e)||t.push(i.lineBlockAt(e));return t}const Y=re.define({create(){return R.none},update(i,t){t.isUserEvent("delete")&&t.changes.iterChangedRanges((e,n)=>i=De(i,e,n)),i=i.map(t.changes);for(let e of t.effects)if(e.is(pt)&&!ur(i,e.value.from,e.value.to)){let{preparePlaceholder:n}=t.state.facet(me),r=n?R.replace({widget:new mr(n(t.state,e.value))}):Me;i=i.update({add:[r.range(e.value.from,e.value.to)]})}else e.is(ft)&&(i=i.update({filter:(n,r)=>e.value.from!=n||e.value.to!=r,filterFrom:e.value.from,filterTo:e.value.to}));return t.selection&&(i=De(i,t.selection.main.head)),i},provide:i=>F.decorations.from(i),toJSON(i,t){let e=[];return i.between(0,t.doc.length,(n,r)=>{e.push(n,r)}),e},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let e=0;e<i.length;){let n=i[e++],r=i[e++];if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");t.push(Me.range(n,r))}return R.set(t,!0)}});function De(i,t,e=t){let n=!1;return i.between(t,e,(r,s)=>{r<e&&s>t&&(n=!0)}),n?i.update({filterFrom:t,filterTo:e,filter:(r,s)=>r>=e||s<=t}):i}function fr(i){return i.field(Y,!1)||Fe.empty}function Ct(i,t,e){var n;let r=null;return(n=i.field(Y,!1))===null||n===void 0||n.between(t,e,(s,l)=>{(!r||r.from>s)&&(r={from:s,to:l})}),r}function ur(i,t,e){let n=!1;return i.between(t,t,(r,s)=>{r==t&&s==e&&(n=!0)}),n}function ge(i,t){return i.field(Y,!1)?t:t.concat(Ft.appendConfig.of(ke()))}const on=i=>{for(let t of pe(i)){let e=dt(i.state,t.from,t.to);if(e)return i.dispatch({effects:ge(i.state,[pt.of(e),zt(i,e)])}),!0}return!1},an=i=>{if(!i.state.field(Y,!1))return!1;let t=[];for(let e of pe(i)){let n=Ct(i.state,e.from,e.to);n&&t.push(ft.of(n),zt(i,n,!1))}return t.length&&i.dispatch({effects:t}),t.length>0};function zt(i,t,e=!0){let n=i.state.doc.lineAt(t.from).number,r=i.state.doc.lineAt(t.to).number;return F.announce.of(`${i.state.phrase(e?"Folded lines":"Unfolded lines")} ${n} ${i.state.phrase("to")} ${r}.`)}const hn=i=>{let{state:t}=i,e=[];for(let n=0;n<t.doc.length;){let r=i.lineBlockAt(n),s=dt(t,r.from,r.to);s&&e.push(pt.of(s)),n=(s?i.lineBlockAt(s.to):r).to+1}return e.length&&i.dispatch({effects:ge(i.state,e)}),!!e.length},fn=i=>{let t=i.state.field(Y,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,i.state.doc.length,(n,r)=>{e.push(ft.of({from:n,to:r}))}),i.dispatch({effects:e}),!0};function cr(i,t){for(let e=t;;){let n=dt(i.state,e.from,e.to);if(n&&n.to>t.from)return n;if(!e.from)return null;e=i.lineBlockAt(e.from-1)}}const dr=i=>{let t=[];for(let e of pe(i)){let n=Ct(i.state,e.from,e.to);if(n)t.push(ft.of(n),zt(i,n,!1));else{let r=cr(i,e);r&&t.push(pt.of(r),zt(i,r))}}return t.length>0&&i.dispatch({effects:ge(i.state,t)}),!!t.length},pr=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:on},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:an},{key:"Ctrl-Alt-[",run:hn},{key:"Ctrl-Alt-]",run:fn}],gr={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},me=K.define({combine(i){return We(i,gr)}});function ke(i){let t=[Y,yr];return i&&t.push(me.of(i)),t}function un(i,t){let{state:e}=i,n=e.facet(me),r=l=>{let o=i.lineBlockAt(i.posAtDOM(l.target)),a=Ct(i.state,o.from,o.to);a&&i.dispatch({effects:ft.of(a)}),l.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(i,r,t);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",e.phrase("folded code")),s.title=e.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const Me=R.replace({widget:new class extends He{toDOM(i){return un(i,null)}}});class mr extends He{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return un(t,this.value)}}const kr={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Gt extends Pn{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function br(i={}){let t={...kr,...i},e=new Gt(t,!0),n=new Gt(t,!1),r=jt.fromClass(class{constructor(l){this.from=l.viewport.from,this.markers=this.buildMarkers(l)}update(l){(l.docChanged||l.viewportChanged||l.startState.facet(X)!=l.state.facet(X)||l.startState.field(Y,!1)!=l.state.field(Y,!1)||L(l.startState)!=L(l.state)||t.foldingChanged(l))&&(this.markers=this.buildMarkers(l.view))}buildMarkers(l){let o=new ne;for(let a of l.viewportLineBlocks){let h=Ct(l.state,a.from,a.to)?n:dt(l.state,a.from,a.to)?e:null;h&&o.add(a.from,a.from,h)}return o.finish()}}),{domEventHandlers:s}=t;return[r,An({class:"cm-foldGutter",markers(l){var o;return((o=l.plugin(r))===null||o===void 0?void 0:o.markers)||Fe.empty},initialSpacer(){return new Gt(t,!1)},domEventHandlers:{...s,click:(l,o,a)=>{if(s.click&&s.click(l,o,a))return!0;let h=Ct(l.state,o.from,o.to);if(h)return l.dispatch({effects:ft.of(h)}),!0;let f=dt(l.state,o.from,o.to);return f?(l.dispatch({effects:pt.of(f)}),!0):!1}}}),ke()]}const yr=F.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Pt{constructor(t,e){this.specs=t;let n;function r(o){let a=Ce.newName();return(n||(n=Object.create(null)))["."+a]=o,a}const s=typeof e.all=="string"?e.all:e.all?r(e.all):void 0,l=e.scope;this.scope=l instanceof E?o=>o.prop(rt)==l.data:l?o=>o==l:void 0,this.style=Je(t.map(o=>({tag:o.tag,class:o.class||r(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new Ce(n):null,this.themeType=e.themeType}static define(t,e){return new Pt(t,e||{})}}const Yt=K.define(),cn=K.define({combine(i){return i.length?[i[0]]:null}});function Et(i){let t=i.facet(Yt);return t.length?t:i.facet(cn)}function xr(i,t){let e=[Sr],n;return i instanceof Pt&&(i.module&&e.push(F.styleModule.of(i.module)),n=i.themeType),t?.fallback?e.push(cn.of(i)):n?e.push(Yt.computeN([F.darkTheme],r=>r.facet(F.darkTheme)==(n=="dark")?[i]:[])):e.push(Yt.of(i)),e}function wr(i,t,e){let n=Et(i),r=null;if(n){for(let s of n)if(!s.scope||e&&s.scope(e)){let l=s.style(t);l&&(r=r?r+" "+l:l)}}return r}class vr{constructor(t){this.markCache=Object.create(null),this.tree=L(t.state),this.decorations=this.buildDeco(t,Et(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=L(t.state),n=Et(t.state),r=n!=Et(t.startState),{viewport:s}=t.view,l=t.changes.mapPos(this.decoratedTo,1);e.length<s.to&&!r&&e.type==this.tree.type&&l>=s.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=l):(e!=this.tree||t.viewportChanged||r)&&(this.tree=e,this.decorations=this.buildDeco(t.view,n),this.decoratedTo=s.to)}buildDeco(t,e){if(!e||!this.tree.length)return R.none;let n=new ne;for(let{from:r,to:s}of t.visibleRanges)Hn(this.tree,e,(l,o,a)=>{n.add(l,o,this.markCache[a]||(this.markCache[a]=R.mark({class:a})))},r,s);return n.finish()}}const Sr=je.high(jt.fromClass(vr,{decorations:i=>i.decorations})),Cr=Pt.define([{tag:c.meta,color:"#404740"},{tag:c.link,textDecoration:"underline"},{tag:c.heading,textDecoration:"underline",fontWeight:"bold"},{tag:c.emphasis,fontStyle:"italic"},{tag:c.strong,fontWeight:"bold"},{tag:c.strikethrough,textDecoration:"line-through"},{tag:c.keyword,color:"#708"},{tag:[c.atom,c.bool,c.url,c.contentSeparator,c.labelName],color:"#219"},{tag:[c.literal,c.inserted],color:"#164"},{tag:[c.string,c.deleted],color:"#a11"},{tag:[c.regexp,c.escape,c.special(c.string)],color:"#e40"},{tag:c.definition(c.variableName),color:"#00f"},{tag:c.local(c.variableName),color:"#30a"},{tag:[c.typeName,c.namespace],color:"#085"},{tag:c.className,color:"#167"},{tag:[c.special(c.variableName),c.macroName],color:"#256"},{tag:c.definition(c.propertyName),color:"#00c"},{tag:c.comment,color:"#940"},{tag:c.invalid,color:"#f00"}]),Ar=F.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),dn=1e4,pn="()[]{}",gn=K.define({combine(i){return We(i,{afterCursor:!0,brackets:pn,maxScanDistance:dn,renderMatch:Nr})}}),Pr=R.mark({class:"cm-matchingBracket"}),Tr=R.mark({class:"cm-nonmatchingBracket"});function Nr(i){let t=[],e=i.matched?Pr:Tr;return t.push(e.range(i.start.from,i.start.to)),i.end&&t.push(e.range(i.end.from,i.end.to)),t}const Ir=re.define({create(){return R.none},update(i,t){if(!t.docChanged&&!t.selection)return i;let e=[],n=t.state.facet(gn);for(let r of t.state.selection.ranges){if(!r.empty)continue;let s=bt(t.state,r.head,-1,n)||r.head>0&&bt(t.state,r.head-1,1,n)||n.afterCursor&&(bt(t.state,r.head,1,n)||r.head<t.state.doc.length&&bt(t.state,r.head+1,-1,n));s&&(e=e.concat(n.renderMatch(s,t.state)))}return R.set(e,!0)},provide:i=>F.decorations.from(i)}),Br=[Ir,Ar];function Or(i={}){return[gn.of(i),Br]}const mn=new y;function Zt(i,t,e){let n=i.prop(t<0?y.openedBy:y.closedBy);if(n)return n;if(i.name.length==1){let r=e.indexOf(i.name);if(r>-1&&r%2==(t<0?1:0))return[e[r+t]]}return null}function te(i){let t=i.type.prop(mn);return t?t(i.node):i}function bt(i,t,e,n={}){let r=n.maxScanDistance||dn,s=n.brackets||pn,l=L(i),o=l.resolveInner(t,e);for(let a=o;a;a=a.parent){let h=Zt(a.type,e,s);if(h&&a.from<a.to){let f=te(a);if(f&&(e>0?t>=f.from&&t<f.to:t>f.from&&t<=f.to))return Dr(i,t,e,a,f,h,s)}}return Mr(i,t,e,l,o.type,r,s)}function Dr(i,t,e,n,r,s,l){let o=n.parent,a={from:r.from,to:r.to},h=0,f=o?.cursor();if(f&&(e<0?f.childBefore(n.from):f.childAfter(n.to)))do if(e<0?f.to<=n.from:f.from>=n.to){if(h==0&&s.indexOf(f.type.name)>-1&&f.from<f.to){let d=te(f);return{start:a,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(Zt(f.type,e,l))h++;else if(Zt(f.type,-e,l)){if(h==0){let d=te(f);return{start:a,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}h--}}while(e<0?f.prevSibling():f.nextSibling());return{start:a,matched:!1}}function Mr(i,t,e,n,r,s,l){let o=e<0?i.sliceDoc(t-1,t):i.sliceDoc(t,t+1),a=l.indexOf(o);if(a<0||a%2==0!=e>0)return null;let h={from:e<0?t-1:t,to:e>0?t+1:t},f=i.doc.iterRange(t,e>0?i.doc.length:0),d=0;for(let g=0;!f.next().done&&g<=s;){let k=f.value;e<0&&(g+=k.length);let w=t+g*e;for(let O=e>0?0:k.length-1,j=e>0?k.length:-1;O!=j;O+=e){let M=l.indexOf(k[O]);if(!(M<0||n.resolveInner(w+O,1).type!=r))if(M%2==0==e>0)d++;else{if(d==1)return{start:h,end:{from:w+O,to:w+O+1},matched:M>>1==a>>1};d--}}e>0&&(g+=k.length)}return f.done?{start:h,matched:!1}:null}function Ee(i,t,e,n=0,r=0){t==null&&(t=i.search(/[^\s\u00a0]/),t==-1&&(t=i.length));let s=r;for(let l=n;l<t;l++)i.charCodeAt(l)==9?s+=e-s%e:s++;return s}class be{constructor(t,e,n,r){this.string=t,this.tabSize=e,this.indentUnit=n,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e=this.string.charAt(this.pos),n;if(typeof t=="string"?n=e==t:n=e&&(t instanceof RegExp?t.test(e):t(e)),n)return++this.pos,e}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ee(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var t;return(t=this.overrideIndent)!==null&&t!==void 0?t:Ee(this.string,null,this.tabSize)}match(t,e,n){if(typeof t=="string"){let r=l=>n?l.toLowerCase():l,s=this.string.substr(this.pos,t.length);return r(s)==r(t)?(e!==!1&&(this.pos+=t.length),!0):null}else{let r=this.string.slice(this.pos).match(t);return r&&r.index>0?null:(r&&e!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function Er(i){return{name:i.name||"",token:i.token,blankLine:i.blankLine||(()=>{}),startState:i.startState||(()=>!0),copyState:i.copyState||Rr,indent:i.indent||(()=>null),languageData:i.languageData||{},tokenTable:i.tokenTable||we,mergeTokens:i.mergeTokens!==!1}}function Rr(i){if(typeof i!="object")return i;let t={};for(let e in i){let n=i[e];t[e]=n instanceof Array?n.slice():n}return t}const Re=new WeakMap;class ye extends E{constructor(t){let e=ae(t.languageData),n=Er(t),r,s=new class extends qe{createParse(l,o,a){return new Lr(r,l,o,a)}};super(e,s,[],t.name),this.topNode=jr(e,this),r=this,this.streamParser=n,this.stateAfter=new y({perNode:!0}),this.tokenTable=t.tokenTable?new xn(n.tokenTable):Fr}static define(t){return new ye(t)}getIndent(t){let e,{overrideIndentation:n}=t.options;n&&(e=Re.get(t.state),e!=null&&e<t.pos-1e4&&(e=void 0));let r=xe(this,t.node.tree,t.node.from,t.node.from,e??t.pos),s,l;if(r?(l=r.state,s=r.pos+1):(l=this.streamParser.startState(t.unit),s=t.node.from),t.pos-s>1e4)return null;for(;s<t.pos;){let a=t.state.doc.lineAt(s),h=Math.min(t.pos,a.to);if(a.length){let f=n?n(a.from):-1,d=new be(a.text,t.state.tabSize,t.unit,f<0?void 0:f);for(;d.pos<h-a.from;)bn(this.streamParser.token,d,l)}else this.streamParser.blankLine(l,t.unit);if(h==t.pos)break;s=a.to+1}let o=t.lineAt(t.pos);return n&&e==null&&Re.set(t.state,o.from),this.streamParser.indent(l,/^\s*(.*)/.exec(o.text)[1],t)}get allowsNesting(){return!1}}function xe(i,t,e,n,r){let s=e>=n&&e+t.length<=r&&t.prop(i.stateAfter);if(s)return{state:i.streamParser.copyState(s),pos:e+t.length};for(let l=t.children.length-1;l>=0;l--){let o=t.children[l],a=e+t.positions[l],h=o instanceof C&&a<r&&xe(i,o,a,n,r);if(h)return h}return null}function kn(i,t,e,n,r){if(r&&e<=0&&n>=t.length)return t;!r&&e==0&&t.type==i.topNode&&(r=!0);for(let s=t.children.length-1;s>=0;s--){let l=t.positions[s],o=t.children[s],a;if(l<n&&o instanceof C){if(!(a=kn(i,o,e-l,n-l,r)))break;return r?new C(t.type,t.children.slice(0,s).concat(a),t.positions.slice(0,s+1),l+a.length):a}}return null}function _r(i,t,e,n,r){for(let s of t){let l=s.from+(s.openStart?25:0),o=s.to-(s.openEnd?25:0),a=l<=e&&o>e&&xe(i,s.tree,0-s.offset,e,o),h;if(a&&a.pos<=n&&(h=kn(i,s.tree,e+s.offset,a.pos+s.offset,!1)))return{state:a.state,tree:h}}return{state:i.streamParser.startState(r?St(r):4),tree:C.empty}}class Lr{constructor(t,e,n,r){this.lang=t,this.input=e,this.fragments=n,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=ht.get(),l=r[0].from,{state:o,tree:a}=_r(t,n,l,this.to,s?.state);this.state=o,this.parsedPos=this.chunkStart=l+a.length;for(let h=0;h<a.children.length;h++)this.chunks.push(a.children[h]),this.chunkPos.push(a.positions[h]);s&&this.parsedPos<s.viewport.from-1e5&&r.some(h=>h.from<=s.viewport.from&&h.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(St(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let t=ht.get(),e=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(e,this.chunkStart+512);for(t&&(n=Math.min(n,t.viewport.to));this.parsedPos<n;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)e==`
`&&(e="");else{let n=e.indexOf(`
`);n>-1&&(e=e.slice(0,n))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),n=t+e.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=n||(e=e.slice(0,s-(n-e.length)),r++,r==this.ranges.length))break;let l=this.ranges[r].from,o=this.lineAfter(l);e+=o,n=l+o.length}return{line:e,end:n}}skipGapsTo(t,e,n){for(;;){let r=this.ranges[this.rangeIndex].to,s=t+e;if(n>0?r>s:r>=s)break;let l=this.ranges[++this.rangeIndex].from;e+=l-r}return e}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(t,e,n,r){let s=4;if(this.ranges.length>1){r=this.skipGapsTo(e,r,1),e+=r;let o=this.chunk.length;r=this.skipGapsTo(n,r,-1),n+=r,s+=this.chunk.length-o}let l=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&l>=0&&this.chunk[l]==t&&this.chunk[l+2]==e?this.chunk[l+2]=n:this.chunk.push(t,e,n,s),r}parseLine(t){let{line:e,end:n}=this.nextLine(),r=0,{streamParser:s}=this.lang,l=new be(e,t?t.state.tabSize:4,t?St(t.state):2);if(l.eol())s.blankLine(this.state,l.indentUnit);else for(;!l.eol();){let o=bn(s.token,l,this.state);if(o&&(r=this.emitToken(this.lang.tokenTable.resolve(o),this.parsedPos+l.start,this.parsedPos+l.pos,r)),l.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=C.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:zr,topID:0,maxBufferLength:512,reused:this.chunkReused});t=new C(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new C(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function bn(i,t,e){t.start=t.pos;for(let n=0;n<10;n++){let r=i(t,e);if(t.pos>t.start)return r}throw new Error("Stream parser failed to advance stream.")}const we=Object.create(null),At=[_.none],zr=new ie(At),_e=[],Le=Object.create(null),yn=Object.create(null);for(let[i,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])yn[i]=wn(we,t);class xn{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),yn)}resolve(t){return t?this.table[t]||(this.table[t]=wn(this.extra,t)):0}}const Fr=new xn(we);function Jt(i,t){_e.indexOf(i)>-1||(_e.push(i),console.warn(t))}function wn(i,t){let e=[];for(let o of t.split(" ")){let a=[];for(let h of o.split(".")){let f=i[h]||c[h];f?typeof f=="function"?a.length?a=a.map(f):Jt(h,`Modifier ${h} used at start of tag`):a.length?Jt(h,`Tag ${h} used as modifier`):a=Array.isArray(f)?f:[f]:Jt(h,`Unknown highlighting tag ${h}`)}for(let h of a)e.push(h)}if(!e.length)return 0;let n=t.replace(/ /g,"_"),r=n+" "+e.map(o=>o.id),s=Le[r];if(s)return s.id;let l=Le[r]=_.define({id:At.length,name:n,props:[jn({[n]:e})]});return At.push(l),l.id}function jr(i,t){let e=_.define({id:At.length,name:"Document",props:[rt.add(()=>i),de.add(()=>n=>t.getIndent(n))],top:!0});return At.push(e),e}function vn(i){return i.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(i)}function Sn(i){for(let t=i.iter();!t.next().done;)if(vn(t.value))return!0;return!1}function Wr(i){let t=!1;return i.iterChanges((e,n,r,s,l)=>{!t&&Sn(l)&&(t=!0)}),t}const ee=K.define({combine:i=>i.some(t=>t)});function Hr(i={}){let t=[Ur];return i.alwaysIsolate&&t.push(ee.of(!0)),t}const Ur=jt.fromClass(class{constructor(i){this.always=i.state.facet(ee)||i.textDirection!=Rt.LTR||i.state.facet(F.perLineTextDirection),this.hasRTL=!this.always&&Sn(i.state.doc),this.tree=L(i.state),this.decorations=this.always||this.hasRTL?ze(i,this.tree,this.always):R.none}update(i){let t=i.state.facet(ee)||i.view.textDirection!=Rt.LTR||i.state.facet(F.perLineTextDirection);if(!t&&!this.hasRTL&&Wr(i.changes)&&(this.hasRTL=!0),!t&&!this.hasRTL)return;let e=L(i.state);(t!=this.always||e!=this.tree||i.docChanged||i.viewportChanged)&&(this.tree=e,this.always=t,this.decorations=ze(i.view,e,t))}},{provide:i=>{function t(e){var n,r;return(r=(n=e.plugin(i))===null||n===void 0?void 0:n.decorations)!==null&&r!==void 0?r:R.none}return[F.outerDecorations.of(t),je.lowest(F.bidiIsolatedRanges.of(t))]}});function ze(i,t,e){let n=new ne,r=i.visibleRanges;e||(r=Vr(r,i.state.doc));for(let{from:s,to:l}of r)t.iterate({enter:o=>{let a=o.type.prop(y.isolate);a&&n.add(o.from,o.to,$r[a])},from:s,to:l});return n.finish()}function Vr(i,t){let e=t.iter(),n=0,r=[],s=null;for(let{from:l,to:o}of i)if(!(s&&s.to>l&&(l=s.to,l>=o)))for(n+e.value.length<l&&(e.next(l-(n+e.value.length)),n=l);;){let a=n,h=n+e.value.length;if(!e.lineBreak&&vn(e.value)&&(s&&s.to>a-10?s.to=Math.min(o,h):r.push(s={from:a,to:Math.min(o,h)})),h>=o)break;n=h,e.next()}return r}const $r={rtl:R.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:Rt.RTL}),ltr:R.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:Rt.LTR}),auto:R.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})},Kr=Object.freeze(Object.defineProperty({__proto__:null,DocInput:Xe,HighlightStyle:Pt,IndentContext:Wt,LRLanguage:Lt,Language:E,LanguageDescription:he,LanguageSupport:Jn,ParseContext:ht,StreamLanguage:ye,StringStream:be,TreeIndentContext:Ht,bidiIsolates:Hr,bracketMatching:Or,bracketMatchingHandle:mn,codeFolding:ke,continuedIndent:ir,defaultHighlightStyle:Cr,defineLanguageFacet:ae,delimitedIndent:nr,ensureSyntaxTree:Qe,flatIndent:rr,foldAll:hn,foldCode:on,foldEffect:pt,foldGutter:br,foldInside:or,foldKeymap:pr,foldNodeProp:sn,foldService:rn,foldState:Y,foldable:dt,foldedRanges:fr,forceParsing:qn,getIndentUnit:St,getIndentation:ce,highlightingFor:wr,indentNodeProp:de,indentOnInput:lr,indentRange:Kn,indentService:tn,indentString:ue,indentUnit:fe,language:X,languageDataProp:rt,matchBrackets:bt,sublanguageProp:Ke,syntaxHighlighting:xr,syntaxParserRunning:Gn,syntaxTree:L,syntaxTreeAvailable:$n,toggleFold:dr,unfoldAll:fn,unfoldCode:an,unfoldEffect:ft},Symbol.toStringTag,{value:"Module"}));export{Nn as D,Pt as H,I,Jn as L,ie as N,qe as P,C as T,Lt as a,or as b,ir as c,rr as d,nr as e,sn as f,_ as g,y as h,de as i,Wt as j,ce as k,ue as l,L as m,bt as n,St as o,fe as p,xr as q,Kr as r,jn as s,c as t};
