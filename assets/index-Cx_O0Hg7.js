import{e as A,f as ut,g as It,o as Lt,i as z,u as ht,c as at,S as Ct,F as jt,b as F,s as ot,d as n,h as X,t as V,j as Gt,a as Ht}from"./index-D_hwyB59.js";class Ot{constructor(e){this.plan=null,this.progress=new Set,this.layoutCache=[],this.layoutHeight=0,this.layoutStrategy=e}setStrategy(e){this.layoutStrategy=e,this.layoutCache=[]}loadPlan(e){if(!e.problems||!Array.isArray(e.problems))throw new Error("Invalid Plan: Missing 'problems' array.");this.plan=e,this.layoutCache=[]}loadProgress(e){this.progress=new Set(e)}toggle(e){this.progress.has(e)?this.progress.delete(e):this.progress.add(e)}resetProgress(){this.progress.clear()}getProgress(){return Array.from(this.progress)}compute(e){if(!this.plan)return null;if(this.containerWidth!==e||this.layoutCache.length===0){this.containerWidth=e;const a=this.layoutStrategy.calculate(this.plan.problems,e);this.layoutCache=a.nodes,this.layoutHeight=a.height}const r=this.layoutCache.map(a=>{const l=this.resolveStatus(a.id,a.prereqs);return{...a,status:l}}),c=this.generateEdges(r);return{nodes:r,edges:c,width:e,height:this.layoutHeight,stats:{total:r.length,completed:this.progress.size,percent:r.length?Math.round(this.progress.size/r.length*100):0}}}resolveStatus(e,r=[]){if(this.progress.has(e))return"completed";const c=r.filter(l=>this.plan?.problems.find(v=>v.id===l));return c.every(l=>this.progress.has(l))||c.length===0?"available":"locked"}generateEdges(e){const r=[],c=new Map(e.map(a=>[a.id,a]));return e.forEach(a=>{a.prereqs&&a.prereqs.forEach(l=>{const v=c.get(l);if(!v)return;const d=v.x+v.width/2,C=v.y+v.height,$=a.x+a.width/2,E=a.y,j=(C+E)/2,g=`M ${d} ${C} C ${d} ${j}, ${$} ${j}, ${$} ${E}`;let S="locked";v.status==="completed"?S="completed":v.status==="available"&&(S="available"),r.push({id:`${l}-${a.id}`,from:l,to:a.id,path:g,status:S})})}),r}}function At(k,e){const r=new Ot(k()),[c,a]=A(null),l=()=>a(r.compute(e()));return ut(It([k,e],([d,C])=>{r.setStrategy(d),l()})),[c,{loadPlan:d=>{r.loadPlan(d),l()},loadProgress:d=>{r.loadProgress(d),l()},toggle:d=>{r.toggle(d),l()},reset:()=>{r.resetProgress(),l()}}]}class Nt{constructor(e={itemSize:200,gap:20}){this.config=e}calculate(e,r){const{itemSize:c,gap:a}=this.config,l=Math.floor(r/(c+a))||1,v=[];e.forEach((C,$)=>{const E=$%l,j=Math.floor($/l);v.push({...C,x:E*(c+a)+a,y:j*(c+a)+a,width:c,height:c,status:"locked"})});const d=Math.ceil(e.length/l);return{nodes:v,height:d*(c+a)+a}}}class Mt{constructor(e={}){const r={nodeWidth:240,nodeHeight:100,gapX:30,gapY:80};this.config={...r,...e}}calculate(e,r){const{nodeWidth:c,gapX:a,gapY:l}=this.config;let v=Math.floor((r-40)/(c+a));v<1&&(v=1);const d=new Map,C=(g,S=new Set)=>{if(d.has(g))return d.get(g);if(S.has(g))return 0;S.add(g);const m=e.find(L=>L.id===g);if(!m||!m.prereqs?.length)return d.set(g,0),0;let f=-1;m.prereqs.forEach(L=>{e.find(N=>N.id===L)&&(f=Math.max(f,C(L,S)))});const I=f+1;return d.set(g,I),I};e.forEach(g=>C(g.id));const $=[];e.forEach(g=>{const S=d.get(g.id)||0;$[S]||($[S]=[]),$[S].push(g)});const E=[];let j=0;return $.forEach(g=>{if(!g)return;const S=[];let m=[];g.forEach((f,I)=>{m.push(f),(m.length>=v||I===g.length-1)&&(S.push(m),m=[])}),S.forEach(f=>{const I=f.length*c+(f.length-1)*a,L=(r-I)/2;f.forEach((N,p)=>{E.push({...N,x:L+p*(c+a),y:j,width:c,height:this.config.nodeHeight,status:"locked"})}),j+=this.config.nodeHeight+l})}),{nodes:E,height:j}}}const Rt="_Container_zvjaw_2",Ut="_Header_zvjaw_9",Yt="_Brand_zvjaw_21",Jt="_BrandTitle_zvjaw_26",qt="_BrandSubtitle_zvjaw_36",Dt="_Toolbar_zvjaw_45",Ft="_ToolGroup_zvjaw_52",Xt="_Label_zvjaw_58",Vt="_Separator_zvjaw_65",Wt="_StatsBadge_zvjaw_71",Kt="_Button_zvjaw_83",Qt="_ButtonPrimary_zvjaw_106",Zt="_ButtonDanger_zvjaw_112",te="_Viewport_zvjaw_123",ee="_GraphSurface_zvjaw_130",ae="_EmptyState_zvjaw_138",oe="_EmptyIcon_zvjaw_151",re="_EmptyTitle_zvjaw_155",ne="_UploadHeroButton_zvjaw_161",o={Container:Rt,Header:Ut,Brand:Yt,BrandTitle:Jt,BrandSubtitle:qt,Toolbar:Dt,ToolGroup:Ft,Label:Xt,Separator:Vt,StatsBadge:Wt,Button:Kt,ButtonPrimary:Qt,ButtonDanger:Zt,Viewport:te,GraphSurface:ee,EmptyState:ae,EmptyIcon:oe,EmptyTitle:re,UploadHeroButton:ne};var se=V("<div><header><div><h1><span style=color:var(--lt-color-accent)>‚ö°</span> LeetTrack</h1><span></span></div><div><div><span>Plan</span><button>üìÇ Upload</button><input type=file accept=.json style=display:none></div><div></div><div><span>Progress</span><div></div><button>‚¨Ü Load</button><button>‚¨á Save</button><button>Clear</button><input type=file accept=.json style=display:none></div><div></div><div><button></button><button></button></div></div></header><div>"),le=V("<div><div>üó∫Ô∏è</div><h2>No Plan Loaded</h2><p>Upload a JSON plan to start tracking.</p><button>Upload Plan"),ie=V("<div><svg class=lt-layer-edges>"),ce=V("<svg><path></svg>",!1,!0,!1),de=V("<div><div class=lt-node-header><span></span><div class=lt-check></div></div><a target=_blank class=lt-node-title></a><div class=lt-node-meta><span> Prereqs");const vt="leetcode-tracker--plan",gt="leetcode-tracker--progress",zt="leetcode-tracker--theme",ve=()=>{let k,e,r;const[c,a]=A(1e3),[l,v]=A("dark"),[d,C]=A("layered"),[$,E]=A("No Plan Loaded"),[j,g]=A(!1),S=()=>d()==="layered"?new Mt({gapY:100,nodeWidth:240}):new Nt({itemSize:200,gap:20}),[m,f]=At(S,c);Lt(()=>{if(!k)return;const p=new ResizeObserver(_=>a(_[0].contentRect.width));p.observe(k);const b=localStorage.getItem(zt);b&&v(b);const y=localStorage.getItem(vt);if(y)try{const _=JSON.parse(y);f.loadPlan(_),E(_.title||"Untitled")}catch(_){console.error("Failed to load plan",_)}const P=localStorage.getItem(gt);if(P)try{f.loadProgress(JSON.parse(P))}catch(_){console.error("Failed to load progress",_)}g(!0),Ht(()=>p.disconnect())}),ut(()=>{const p=m();if(!j()||!p)return;const b=p.nodes.filter(y=>y.status==="completed").map(y=>y.id);localStorage.setItem(gt,JSON.stringify(b))}),ut(()=>{localStorage.setItem(zt,l())});const I=p=>{const b=p.target,y=b.files?.[0];if(!y)return;const P=new FileReader;P.onload=_=>{try{const B=JSON.parse(_.target?.result);f.loadPlan(B),E(B.title||"Untitled Plan"),localStorage.setItem(vt,JSON.stringify(B))}catch(B){console.error(B),alert("Invalid JSON")}},P.readAsText(y),b.value=""},L=p=>{const b=p.target,y=b.files?.[0];if(!y)return;const P=new FileReader;P.onload=_=>{try{const B=JSON.parse(_.target?.result);f.loadProgress(B)}catch(B){console.error(B),alert("Invalid JSON")}},P.readAsText(y),b.value=""},N=()=>{confirm("Are you sure you want to reset everything?")&&(f.reset(),localStorage.removeItem(gt),localStorage.removeItem(vt),f.loadPlan({title:"",problems:[]}),E("No Plan Loaded"))};return(()=>{var p=se(),b=p.firstChild,y=b.firstChild,P=y.firstChild;P.firstChild;var _=P.nextSibling,B=y.nextSibling,rt=B.firstChild,ft=rt.firstChild,nt=ft.nextSibling,st=nt.nextSibling,St=rt.nextSibling,lt=St.nextSibling,pt=lt.firstChild,it=pt.nextSibling,W=it.nextSibling,K=W.nextSibling,Q=K.nextSibling,ct=Q.nextSibling,yt=lt.nextSibling,mt=yt.nextSibling,Z=mt.firstChild,dt=Z.nextSibling,tt=b.nextSibling;z(_,$),nt.$$click=()=>e?.click(),st.addEventListener("change",I);var _t=e;typeof _t=="function"?ht(_t,st):e=st,z(it,at(Ct,{get when(){return m()},fallback:"0 / 0",children:t=>`${t().stats.completed} / ${t().stats.total}`})),W.$$click=()=>r?.click(),K.$$click=()=>alert("Save not impl"),Q.$$click=N,ct.addEventListener("change",L);var bt=r;typeof bt=="function"?ht(bt,ct):r=ct,Z.$$click=()=>v(t=>t==="dark"?"light":"dark"),z(Z,()=>l()==="dark"?"üåô":"‚òÄÔ∏è"),dt.$$click=()=>C(t=>t==="layered"?"grid":"layered"),z(dt,()=>d()==="layered"?"üå≤":"‚ñ¶");var wt=k;return typeof wt=="function"?ht(wt,tt):k=tt,z(tt,at(Ct,{get when(){return m()},get fallback(){return(()=>{var t=le(),x=t.firstChild,H=x.nextSibling,s=H.nextSibling,h=s.nextSibling;return h.$$click=()=>e?.click(),F(i=>{var T=o.EmptyState,w=o.EmptyIcon,O=o.EmptyTitle,G=`${o.Button} ${o.ButtonPrimary} ${o.UploadHeroButton}`;return T!==i.e&&n(t,i.e=T),w!==i.t&&n(x,i.t=w),O!==i.a&&n(H,i.a=O),G!==i.o&&n(h,i.o=G),i},{e:void 0,t:void 0,a:void 0,o:void 0}),t})()},children:t=>(()=>{var x=ie(),H=x.firstChild;return z(H,at(jt,{get each(){return t().edges},children:s=>(()=>{var h=ce();return F(i=>{var T=s.path,w=`lt-edge ${s.status}`;return T!==i.e&&ot(h,"d",i.e=T),w!==i.t&&ot(h,"class",i.t=w),i},{e:void 0,t:void 0}),h})()})),z(x,at(jt,{get each(){return t().nodes},children:s=>(()=>{var h=de(),i=h.firstChild,T=i.firstChild,w=i.nextSibling,O=w.nextSibling,G=O.firstChild,et=G.firstChild;return h.$$click=()=>f.toggle(s.id),z(T,()=>s.diff),w.$$click=u=>u.stopPropagation(),z(w,()=>s.title||s.id),z(G,()=>(s.prereqs||[]).length,et),F(u=>{var M=`lt-node ${s.status}`,R=`${s.x}px`,U=`${s.y}px`,Y=`${s.width}px`,J=`${s.height}px`,q=`lt-badge ${s.diff}`,D=`https://leetcode.com/problems/${s.id}/`;return M!==u.e&&n(h,u.e=M),R!==u.t&&X(h,"left",u.t=R),U!==u.a&&X(h,"top",u.a=U),Y!==u.o&&X(h,"width",u.o=Y),J!==u.i&&X(h,"min-height",u.i=J),q!==u.n&&n(T,u.n=q),D!==u.s&&ot(w,"href",u.s=D),u},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),h})()}),null),F(s=>{var h=o.GraphSurface,i=`${t().height}px`;return h!==s.e&&n(x,s.e=h),i!==s.t&&X(x,"height",s.t=i),s},{e:void 0,t:void 0}),x})()})),F(t=>{var x=`lt-container ${o.Container}`,H=l(),s=o.Header,h=o.Brand,i=o.BrandTitle,T=o.BrandSubtitle,w=o.Toolbar,O=o.ToolGroup,G=o.Label,et=o.Button,u=o.Separator,M=o.ToolGroup,R=o.Label,U=o.StatsBadge,Y=`${o.Button} ${o.ButtonPrimary}`,J=!m(),q=o.Button,D=!m(),$t=`${o.Button} ${o.ButtonDanger}`,Pt=!m(),Bt=o.Separator,Et=o.ToolGroup,xt=o.Button,Tt=o.Button,kt=`lt-viewport ${o.Viewport}`;return x!==t.e&&n(p,t.e=x),H!==t.t&&ot(p,"data-theme",t.t=H),s!==t.a&&n(b,t.a=s),h!==t.o&&n(y,t.o=h),i!==t.i&&n(P,t.i=i),T!==t.n&&n(_,t.n=T),w!==t.s&&n(B,t.s=w),O!==t.h&&n(rt,t.h=O),G!==t.r&&n(ft,t.r=G),et!==t.d&&n(nt,t.d=et),u!==t.l&&n(St,t.l=u),M!==t.u&&n(lt,t.u=M),R!==t.c&&n(pt,t.c=R),U!==t.w&&n(it,t.w=U),Y!==t.m&&n(W,t.m=Y),J!==t.f&&(W.disabled=t.f=J),q!==t.y&&n(K,t.y=q),D!==t.g&&(K.disabled=t.g=D),$t!==t.p&&n(Q,t.p=$t),Pt!==t.b&&(Q.disabled=t.b=Pt),Bt!==t.T&&n(yt,t.T=Bt),Et!==t.A&&n(mt,t.A=Et),xt!==t.O&&n(Z,t.O=xt),Tt!==t.I&&n(dt,t.I=Tt),kt!==t.S&&n(tt,t.S=kt),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),p})()};Gt(["click"]);export{ve as default};
